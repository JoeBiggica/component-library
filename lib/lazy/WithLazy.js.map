{"version":3,"sources":["../../components/lazy/WithLazy.jsx"],"names":["React","PureComponent","PropTypes","omit","isArray","isObject","WithLazy","lazy_props","InnerComponent","props","ref","intersection_observer","window","IntersectionObserver","entries","entry","in_view","isIntersecting","setState","stopObserve","rootMargin","distance","observe","disconnect","Object","assign","state","createRef","startObserve","current","getLazyProps","string"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,QAAqC,OAArC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAOC,QAAP,MAAqB,iBAArB;;AAGA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAC,UAAU;AAAA,SAAI,UAAAC,cAAc;AAAA;;AAAA;AAAA;;AAAA;;AAU5C,sBAAYC,MAAZ,EAAmB;AAAA;;AAAA;;AAClB,kCAAMA,MAAN;;AADkB,uEAkBJ,UAAAC,GAAG,EAAI;AACrB,gBAAKC,qBAAL,GAA6B,IAAIC,MAAM,CAACC,oBAAX,CAAgC,UAAAC,OAAO,EAAI;AACvE,gBAAMC,KAAK,GAAGD,OAAO,CAAC,CAAD,CAArB;AACA,gBAAME,OAAO,GAAGD,KAAK,CAACE,cAAtB;;AACA,gBAAID,OAAJ,EAAa;AACZ,oBAAKE,QAAL,CAAc;AACbF,gBAAAA,OAAO,EAAE;AADI,eAAd,EAEG,MAAKG,WAFR;AAGA;AACD,WAR4B,EAQ1B;AACFC,YAAAA,UAAU,YAAK,MAAKX,KAAL,CAAWY,QAAhB;AADR,WAR0B,CAA7B;;AAYA,gBAAKV,qBAAL,CAA2BW,OAA3B,CAAmCZ,GAAnC;AACA,SAhCkB;;AAAA,sEAkCL,YAAM;AACnB,cAAI,MAAKC,qBAAT,EAAgC;AAC/B,kBAAKA,qBAAL,CAA2BY,UAA3B;;AACA,kBAAKZ,qBAAL,GAA6B,IAA7B;AACA;AACD,SAvCkB;;AAAA,uEAyCJ,UAACF,KAAD,EAAQF,UAAR,EAAuB;AACrC,cAAIH,OAAO,CAACG,UAAD,CAAX,EAAyB;AACxB,mBAAOJ,IAAI,CAACM,KAAD,EAAQF,UAAR,CAAX;AACA;;AAED,cAAIF,QAAQ,CAACE,UAAD,CAAZ,EAA0B;AACzB,mBAAOiB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBhB,KAAlB,EAAyBF,UAAzB,CAAP;AACA;AACD,SAjDkB;;AAGlB,cAAKmB,KAAL,GAAa;AACZV,UAAAA,OAAO,EAAE;AADG,SAAb;AAIA,cAAKN,GAAL,GAAWV,KAAK,CAAC2B,SAAN,EAAX;AAPkB;AAQlB;;AAlB2C;AAAA;AAAA,4CAoBxB;AACnB,eAAKC,YAAL,CAAkB,KAAKlB,GAAL,CAASmB,OAA3B;AACA;AAtB2C;AAAA;AAAA,+CAwBrB;AACtB,eAAKV,WAAL;AACA;AA1B2C;AAAA;AAAA,iCA6DnC;AACR,cAAMV,KAAK,GAAG,KAAKiB,KAAL,CAAWV,OAAX,GACb,KAAKP,KADQ,GACA,KAAKqB,YAAL,CAAkB,KAAKrB,KAAvB,EAA8BF,UAA9B,CADd;AAGA,8BACC,oBAAC,cAAD,eACKE,KADL;AAEC,YAAA,GAAG,EAAE,KAAKC;AAFX,aADD;AAMA;AAvE2C;;AAAA;AAAA,MAAkBT,aAAlB,wCAEzB;AAClBoB,MAAAA,QAAQ,EAAEnB,SAAS,CAAC6B;AADF,KAFyB,2CAMtB;AACrBV,MAAAA,QAAQ,EAAE;AADW,KANsB;AAAA,GAAlB;AAAA,CAA3B;;AA0EA,eAAef,QAAf","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport omit from 'lodash/omit';\nimport isArray from 'lodash/isArray';\nimport isObject from 'lodash/isObject';\n\n\nconst WithLazy = lazy_props => InnerComponent => class extends PureComponent {\n\n\tstatic propTypes = {\n\t\tdistance: PropTypes.string,\n\t}\n\n\tstatic defaultProps = {\n\t\tdistance: '0px',\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tin_view: false,\n\t\t};\n\n\t\tthis.ref = React.createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.startObserve(this.ref.current);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.stopObserve();\n\t}\n\n\tstartObserve = ref => {\n\t\tthis.intersection_observer = new window.IntersectionObserver(entries => {\n\t\t\tconst entry = entries[0];\n\t\t\tconst in_view = entry.isIntersecting;\n\t\t\tif (in_view) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tin_view: true,\n\t\t\t\t}, this.stopObserve);\n\t\t\t}\n\t\t}, {\n\t\t\trootMargin: `${this.props.distance} 0px`,\n\t\t});\n\n\t\tthis.intersection_observer.observe(ref);\n\t}\n\n\tstopObserve = () => {\n\t\tif (this.intersection_observer) {\n\t\t\tthis.intersection_observer.disconnect();\n\t\t\tthis.intersection_observer = null;\n\t\t}\n\t}\n\n\tgetLazyProps = (props, lazy_props) => {\n\t\tif (isArray(lazy_props)) {\n\t\t\treturn omit(props, lazy_props);\n\t\t}\n\n\t\tif (isObject(lazy_props)) {\n\t\t\treturn Object.assign({}, props, lazy_props);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst props = this.state.in_view ?\n\t\t\tthis.props : this.getLazyProps(this.props, lazy_props);\n\n\t\treturn (\n\t\t\t<InnerComponent\n\t\t\t\t{...props}\n\t\t\t\tref={this.ref}\n\t\t\t/>\n\t\t);\n\t}\n};\n\nexport default WithLazy;\n"],"file":"WithLazy.js"}