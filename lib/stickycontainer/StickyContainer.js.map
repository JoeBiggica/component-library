{"version":3,"sources":["../../components/stickycontainer/StickyContainer.jsx"],"names":["React","PureComponent","PropTypes","classnames","StickyContainer","props","sticky","at_bottom","content_height","top_tracker_ref","createRef","bottom_tracker_ref","content_ref","top_threshold","ignore_bottom","intersection_observer","window","IntersectionObserver","entries","state","forEach","entry","target","current","boundingClientRect","top","isIntersecting","bottom","setState","rootMargin","threshold","observe","size_observer","ResizeObserver","clientHeight","disconnect","prev_props","prev_state","onChange","className","style","children","disabled","styles","height","marginTop","undefined","string","number","bool","object","node","func"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport styles from './StickyContainer.scss';\n\n\nexport default class StickyContainer extends PureComponent {\n\n\tstatic propTypes = {\n\t\tclassName: PropTypes.string,\n\t\ttop_threshold: PropTypes.number,\n\t\tignore_bottom: PropTypes.bool,\n\t\tdisabled: PropTypes.bool,\n\t\tstyle: PropTypes.object,\n\t\tchildren: PropTypes.node,\n\t\tonChange: PropTypes.func,\n\t}\n\n\tstatic defaultProps = {\n\t\ttop_threshold: 0,\n\t\tignore_bottom: false,\n\t\tdisabled: false,\n\t\tonChange: () => {},\n\t}\n\n\tstate = {\n\t\tsticky: false,\n\t\tat_bottom: false,\n\t\tcontent_height: 0,\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.top_tracker_ref = React.createRef();\n\t\tthis.bottom_tracker_ref = React.createRef();\n\t\tthis.content_ref = React.createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\tconst {\n\t\t\ttop_threshold,\n\t\t\tignore_bottom,\n\t\t} = this.props;\n\n\t\tthis.intersection_observer = new window.IntersectionObserver(entries => {\n\t\t\tlet sticky = this.state.sticky;\n\t\t\tlet at_bottom = this.state.at_bottom;\n\n\t\t\tentries.forEach(entry => {\n\t\t\t\tif (entry.target === this.top_tracker_ref.current) {\n\n\t\t\t\t\tsticky = entry.boundingClientRect.top < top_threshold;\n\n\t\t\t\t} else if (!ignore_bottom && entry.target === this.bottom_tracker_ref.current) {\n\t\t\t\t\t\n\t\t\t\t\tif (entry.isIntersecting && \n\t\t\t\t\t\tentry.boundingClientRect.top < top_threshold) {\n\t\t\t\t\t\tsticky = true;\n\t\t\t\t\t\tat_bottom = false;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!entry.isIntersecting && \n\t\t\t\t\t\tentry.boundingClientRect.bottom < top_threshold) {\n\t\t\t\t\t\tat_bottom = true;\n\t\t\t\t\t\tsticky = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.setState({\n\t\t\t\tsticky,\n\t\t\t\tat_bottom,\n\t\t\t});\n\t\t}, {\n\t\t\trootMargin: `${-top_threshold}px 0px 0px 0px`,\n\t\t\tthreshold: [0, 1],\n\t\t});\n\t\tthis.intersection_observer.observe(this.top_tracker_ref.current);\n\t\tthis.intersection_observer.observe(this.bottom_tracker_ref.current);\n\n\t\tthis.size_observer = new window.ResizeObserver(entries => {\n\t\t\tconst entry = entries[0];\n\t\t\tthis.setState({\n\t\t\t\tcontent_height: entry.target.clientHeight,\n\t\t\t});\n\t\t});\n\t\tthis.size_observer.observe(this.content_ref.current);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.intersection_observer.disconnect();\n\t\tthis.intersection_observer = null;\n\n\t\tthis.size_observer.disconnect();\n\t\tthis.size_observer = null;\n\t}\n\n\tcomponentDidUpdate(prev_props, prev_state) {\n\t\tif (prev_state.sticky !== this.state.sticky) {\n\t\t\tthis.props.onChange(this.state.sticky);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tclassName,\n\t\t\tstyle,\n\t\t\tchildren,\n\t\t\ttop_threshold,\n\t\t\tdisabled,\n\t\t} = this.props;\n\n\t\tconst {\n\t\t\tsticky,\n\t\t\tat_bottom,\n\t\t\tcontent_height,\n\t\t} = this.state;\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={classnames(styles['container'], className)}\n\t\t\t\tstyle={style}\n\t\t\t>\n\t\t\t\t<div ref={this.top_tracker_ref} />\n\n\t\t\t\t<div\n\t\t\t\t\tref={this.bottom_tracker_ref}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\theight: `calc(100% - ${content_height}px)`,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\n\t\t\t\t<div\n\t\t\t\t\tref={this.content_ref}\n\t\t\t\t\tclassName={classnames(\n\t\t\t\t\t\tstyles['content'],\n\t\t\t\t\t\tdisabled && styles['disabled'],\n\t\t\t\t\t\tsticky && styles['sticky'],\n\t\t\t\t\t\tat_bottom && styles['bottom']\n\t\t\t\t\t)}\n\t\t\t\t\tstyle={sticky ? {\n\t\t\t\t\t\tmarginTop: `${top_threshold}px`,\n\t\t\t\t\t} : undefined}\n\t\t\t\t>\n\t\t\t\t\t{children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n"],"file":"StickyContainer.js"}