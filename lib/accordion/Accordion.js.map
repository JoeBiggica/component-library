{"version":3,"sources":["../../components/accordion/Accordion.jsx"],"names":["React","PureComponent","PropTypes","classnames","findIndex","isNumber","Accordion","props","refs","index","createRef","ref","getBodyRef","current","offsetHeight","state","active_indices","indexOf","body_heights","map","height","i","isActiveIndex","body_height","getBodyHeight","collapse_others","setState","will_collapse","filter","concat","item","active","body_style","transitionDuration","transition_duration","styles","handleClickHeader","bind","renderHeader","renderBody","initial_active_index","initial_active_indices","push","initial_body_heights","items","body_size_observer","window","ResizeObserver","updateActiveBodyHeights","forEach","observe","disconnect","className","style","renderItem","string","object","array","number","bool","func","isRequired"],"mappings":"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","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport findIndex from 'lodash/findIndex';\nimport isNumber from 'lodash/isNumber';\n\nimport styles from './Accordion.scss';\n\n\nexport default class Accordion extends PureComponent {\n\n\tstatic propTypes = {\n\t\tclassName: PropTypes.string,\n\t\tstyle: PropTypes.object,\n\t\titems: PropTypes.array,\n\t\tinitial_active_index: PropTypes.number,\n\t\ttransition_duration: PropTypes.string,\n\t\tcollapse_others: PropTypes.bool,\n\t\trenderHeader: PropTypes.func.isRequired,\n\t\trenderBody: PropTypes.func.isRequired,\n\t}\n\n\tstatic defaultProps = {\n\t\titems: [],\n\t\ttransition_duration: '400ms',\n\t\tcollapse_others: false,\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tconst initial_active_index = props.initial_active_index;\n\n\t\tconst initial_active_indices = [];\n\t\tif (isNumber(initial_active_index)) {\n\t\t\tinitial_active_indices.push(initial_active_index);\n\t\t}\n\n\t\tconst initial_body_heights = props.items.map((item, index) => {\n\t\t\treturn initial_active_index === index ? 'auto' : '0';\n\t\t});\n\n\t\tthis.state = {\n\t\t\tactive_indices: initial_active_indices,\n\t\t\tbody_heights: initial_body_heights,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.body_size_observer = new window.ResizeObserver(this.updateActiveBodyHeights);\n\n\t\tthis.props.items.forEach((item, index) => {\n\t\t\tconst ref = this.getBodyRef(index);\n\t\t\tthis.body_size_observer.observe(ref.current);\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.body_size_observer.disconnect();\n\t}\n\n\tgetBodyRef = (() => {\n\t\tconst refs = [];\n\n\t\treturn function (index) {\n\t\t\tif (!refs[index]) {\n\t\t\t\trefs[index] = React.createRef();\n\t\t\t}\n\t\t\treturn refs[index];\n\t\t};\n\t})()\n\n\tgetBodyHeight = index => {\n\t\tconst ref = this.getBodyRef(index);\n\n\t\tif (ref) {\n\t\t\treturn ref.current.offsetHeight;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tisActiveIndex = index => {\n\t\treturn this.state.active_indices.indexOf(index) > -1;\n\t}\n\n\tupdateActiveBodyHeights = () => {\n\t\tconst body_heights = this.state.body_heights.map((height, i) => {\n\t\t\tif (this.isActiveIndex(i)) {\n\t\t\t\tconst body_height = this.getBodyHeight(i);\n\t\t\t\treturn `${body_height}px`;\n\t\t\t}\n\n\t\t\treturn this.props.collapse_others ? 0 : height; \n\t\t});\n\n\t\tthis.setState({\n\t\t\tbody_heights,\n\t\t});\n\t}\n\n\thandleClickHeader = index => {\n\t\tconst will_collapse = this.isActiveIndex(index);\n\n\t\tlet active_indices;\n\t\tlet body_heights;\n\n\t\tif (will_collapse) {\n\n\t\t\tbody_heights = this.state.body_heights.map((height, i) => {\n\t\t\t\tif (i === index) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn height; \n\t\t\t});\n\n\t\t\tactive_indices = this.state.active_indices.filter(i => i !== index);\n\n\t\t} else {\n\n\t\t\tbody_heights = this.state.body_heights.map((height, i) => {\n\t\t\t\tif (i === index) {\n\t\t\t\t\tconst body_height = this.getBodyHeight(index);\n\t\t\t\t\treturn `${body_height}px`;\n\t\t\t\t}\n\n\t\t\t\treturn this.props.collapse_others ? 0 : height; \n\t\t\t});\n\n\t\t\tactive_indices = this.props.collapse_others ? [index] : \n\t\t\t\tthis.state.active_indices.concat(index);\n\t\t}\n\n\t\tthis.setState({\n\t\t\tactive_indices,\n\t\t\tbody_heights,\n\t\t});\n\t}\n\n\trenderItem = (item, index) => {\n\t\tconst active = this.isActiveIndex(index);\n\n\t\tconst body_style = {\n\t\t\ttransitionDuration: this.props.transition_duration,\n\t\t\theight: this.state.body_heights[index],\n\t\t};\n\n\t\treturn (\n\t\t\t<li key={index}>\n\t\t\t\t<div\n\t\t\t\t\tclassName={styles['header']}\n\t\t\t\t\tonClick={this.handleClickHeader.bind(this, index)}\n\t\t\t\t>\n\t\t\t\t\t{this.props.renderHeader(item, index, active)}\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName={styles['body']}\n\t\t\t\t\tstyle={body_style}\n\t\t\t\t>\n\t\t\t\t\t<div ref={this.getBodyRef(index)}>\n\t\t\t\t\t\t{this.props.renderBody(item, index, active)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tclassName,\n\t\t\tstyle,\n\t\t\titems,\n\t\t} = this.props;\n\n\t\treturn (\n\t\t\t<ul\n\t\t\t\tclassName={classnames(styles['container'], className)}\n\t\t\t\tstyle={style}\n\t\t\t>\n\t\t\t\t{items.map(this.renderItem)}\n\t\t\t</ul>\n\t\t);\n\t}\n}\n"],"file":"Accordion.js"}